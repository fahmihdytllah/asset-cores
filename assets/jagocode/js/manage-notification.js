$(document).ready(function(){let e=$(".formAddNotification"),o=$(".formEditNotification"),i=$(".formSendNotification"),a;function n(){$("#listNotifications").html(""),$(".card-table").block({message:elementLoader,css:{backgroundColor:"transparent",border:"0"},overlayCSS:{backgroundColor:"#fff",opacity:.8}}),$.get("?type=json",function(t){$(".card-table").unblock(),t.forEach(t=>{var e='<span class="badge '+(t.isActive?"bg-label-success":"bg-label-danger")+'" text-capitalized>'+(t.isActive?"Active":"Non Active")+"</span>";$("#listNotifications").append(`<tr>
          <td><i class="ti ti-${{info:"info-circle",success:"check",warning:"alert-circle",danger:"alert-triangle"}[t.icon]} ti-lg text-${t.icon} me-3"></i> <span class="fw-medium">${t.title}</span></td>
          <td>${t.message}</td>
          <td>${t.platform}</td>
          <td>${e}</td>
          <td>${moment(t.createdAt).format("llll")}</td>
          <td>
            <div class="dropdown">
              <button type="button" class="btn p-0 dropdown-toggle hide-arrow" data-bs-toggle="dropdown"><i class="ti ti-dots-vertical"></i></button>
              <div class="dropdown-menu">
                <a class="dropdown-item Notification-edit" data-id="${t._id}" ><i class="ti ti-pencil me-1"></i> Edit</a>
                <a class="dropdown-item Notification-delete" data-id="${t._id}" ><i class="ti ti-trash me-1"></i> Delete</a>
              </div>
            </div>
          </td>
        </tr>`)})})}n(),$(document).on("click",".Notification-delete",function(){let e=$(this).data("id");Swal.fire({text:"Apakah anda yakin ingin menghapus Notification ini?",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes",customClass:{confirmButton:"btn btn-primary waves-effect waves-light",cancelButton:"btn btn-outline-danger ms-2 waves-effect waves-light"},buttonsStyling:!1}).then(function(t){t.value&&(t=e,$.blockUI({message:elementLoader,css:{backgroundColor:"transparent",border:"0"},overlayCSS:{backgroundColor:"#fff",opacity:.8}}),$.ajax({url:"notification/"+t,type:"DELETE",success:function(t){$.unblockUI(),n(),Swal.fire({title:"Good job!",text:t.msg,icon:"success",customClass:{confirmButton:"btn btn-primary waves-effect waves-light"}})},error:function(t){$.unblockUI();t=t.responseJSON.msg;Swal.fire({title:"Upss!",text:t||"There is an error!",icon:"error",customClass:{confirmButton:"btn btn-primary waves-effect waves-light"}})}}))})}),$(document).on("click",".Notification-edit",function(){var e,t=$(this).data("id");e=t,$.blockUI({message:elementLoader,css:{backgroundColor:"transparent",border:"0"},overlayCSS:{backgroundColor:"#fff",opacity:.8}}),$.ajax({url:"notification/"+e,type:"GET",success:function(t){$.unblockUI(),a=e,$("#editTitle").val(t.title),$("#editIcon").val(t.icon),$("#editMessage").val(t.message),$("#editPlatform").val(t.platform),t.isActive?$("#editIsActive").prop("checked",!0):$("#editIsActive").prop("checked",!1),$("#modalEditNotification").modal("show")},error:function(t){$.unblockUI();t=t.responseJSON.msg;Swal.fire({title:"Upss!",text:t||"There is an error!",icon:"error",customClass:{confirmButton:"btn btn-primary waves-effect waves-light"}})}})}),e.submit(function(t){t.preventDefault(),e.block({message:elementLoader,css:{backgroundColor:"transparent",border:"0"},overlayCSS:{backgroundColor:"#fff",opacity:.8}}),$.ajax({url:"notification",type:"POST",data:$(this).serialize(),success:function(t){n(),e.unblock(),e[0].reset(),$("#modalAddNotification").modal("hide"),Swal.fire({title:"Good job!",text:t.msg,icon:"success",customClass:{confirmButton:"btn btn-primary waves-effect waves-light"}})},error:function(t){e.unblock();t=t.responseJSON.msg;Swal.fire({title:"Upss!",text:t||"There is an error!",icon:"error",customClass:{confirmButton:"btn btn-primary waves-effect waves-light"}})}})}),o.submit(function(t){t.preventDefault(),o.block({message:elementLoader,css:{backgroundColor:"transparent",border:"0"},overlayCSS:{backgroundColor:"#fff",opacity:.8}}),$.ajax({url:"notification/"+a,type:"PUT",data:$(this).serialize(),success:function(t){n(),o.unblock(),o[0].reset(),$("#modalEditNotification").modal("hide"),Swal.fire({title:"Good job!",text:t.msg,icon:"success",customClass:{confirmButton:"btn btn-primary waves-effect waves-light"}})},error:function(t){o.unblock();t=t.responseJSON.msg;Swal.fire({title:"Upss!",text:t||"There is an error!",icon:"error",customClass:{confirmButton:"btn btn-primary waves-effect waves-light"}})}})}),i.submit(function(t){t.preventDefault(),i.block({message:elementLoader,css:{backgroundColor:"transparent",border:"0"},overlayCSS:{backgroundColor:"#fff",opacity:.8}}),$.ajax({url:"notification/?",type:"PATCH",data:$(this).serialize(),success:function(t){i.unblock(),i[0].reset(),$("#modalSendNotification").modal("hide"),Swal.fire({title:"Good job!",text:t.msg,icon:"success",customClass:{confirmButton:"btn btn-primary waves-effect waves-light"},buttonsStyling:!1})},error:function(t){i.unblock();t=t.responseJSON.msg;Swal.fire({title:"Upss!",text:t||"There is an error!",icon:"error",customClass:{confirmButton:"btn btn-primary waves-effect waves-light"},buttonsStyling:!1})}})})});