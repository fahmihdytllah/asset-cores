$(function(){var e=document.querySelector(".comment-editor"),t=document.querySelector("#portfolio-media"),o=document.querySelector("#portfolio-date"),a=document.querySelector("#portfolio-category"),r=document.querySelector("#portfolio-technologies"),i=$(".select2");let n,l=[];firebase.initializeApp({apiKey:"AIzaSyClXd1AAB_Nzlm52X4GB7V9TR0Rv8YCu1w",authDomain:"jago-code.firebaseapp.com",projectId:"jago-code",storageBucket:"jago-code.appspot.com",messagingSenderId:"733341114140",appId:"1:733341114140:web:aee7d8fd24e979e9bba4d9",measurementId:"G-4CDRVEBPJD"});let s=firebase.storage();i.length&&i.each(function(){var e=$(this);e.wrap('<div class="position-relative"></div>').select2({dropdownParent:e.parent(),placeholder:e.data("placeholder")})}),$("#changeView").on("change",function(){"html"===this.value?($("#content-html").show(),$("#content-text").hide(),$("#content-html").val(n.root.innerHTML)):($("#content-text").show(),$("#content-html").hide(),n.clipboard.dangerouslyPasteHTML($("#content-html").val()))}),e&&(n=new Quill(e,{modules:{toolbar:{container:[[{font:[]}],[{header:[1,2,3,4,5,6,!1]}],["bold","italic","underline","strike"],[{color:[]},{background:[]}],[{script:"sub"},{script:"super"}],[{list:"ordered"},{list:"bullet"}],[{align:[]}],["blockquote","code-block"],["link","image","video"],["clean"]],handlers:{image:function(){let e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("accept","image/*"),e.click(),e.onchange=function(){var t=e.files[0];if(t){let e=s.ref().child("portfolios/"+t.name).put(t);e.on("state_changed",e=>{e=e.bytesTransferred/e.totalBytes*100;console.log("Upload progress: "+e+"%")},e=>{console.error("Error uploading file: ",e)},()=>{e.snapshot.ref.getDownloadURL().then(e=>{var t=n.getSelection();n.insertEmbed(t.index,"image",e)})})}}}}}},placeholder:"Content Portfolio",theme:"snow"}));t&&new Dropzone(t,{previewTemplate:`<div class="dz-preview dz-file-preview">
<div class="dz-details">
  <div class="dz-thumbnail">
    <img data-dz-thumbnail>
    <span class="dz-nopreview">No preview</span>
    <div class="dz-success-mark"></div>
    <div class="dz-error-mark"></div>
    <div class="dz-error-message"><span data-dz-errormessage></span></div>
    <div class="progress">
      <div class="progress-bar progress-bar-primary" role="progressbar" aria-valuemin="0" aria-valuemax="100" data-dz-uploadprogress></div>
    </div>
  </div>
  <div class="dz-filename" data-dz-name></div>
  <div class="dz-size" data-dz-size></div>
</div>
</div>`,parallelUploads:1,maxFilesize:5,acceptedFiles:".jpg,.jpeg,.png,.gif",addRemoveLinks:!0,maxFiles:5,init:function(){this.on("addedfile",t=>{if(t){let e=s.ref().child("portfolios/"+t.name).put(t);e.on("state_changed",e=>{e=e.bytesTransferred/e.totalBytes*100;console.log("Upload progress: "+e+"%")},e=>{console.error("Error uploading file: ",e)},()=>{e.snapshot.ref.getDownloadURL().then(e=>{l.push(e)})})}})}});i=$(".img-gallery").map(function(){return $(this).attr("src")}).get();l=i,$(document).on("click",".delete-btn",function(){let t=$(this).data("url");var e=$(this).data("id");l=l.filter(e=>e!==t),$("#media-"+e).remove()}),new Tagify(a,{whitelist:["SaaS Software","Web Development","Mobile App","Design","Other"],maxTags:10,dropdown:{maxItems:10,enabled:0,closeOnSelect:!1}}),new Tagify(r,{whitelist:["Bootstrap","Laravel","Next.Js","Express.Js","Socket.Io","HTML","PHP","JavaScript","CSS","Node.Js"],maxTags:10,dropdown:{maxItems:10,enabled:0,closeOnSelect:!1}});o&&o.flatpickr({mode:"range"}),$(".btn-discard").click(function(){window.location.href="/portfolio"}),$(".btn-save").click(function(){var e=JSON.parse($("#portfolio-category").val()).map(function(e){return e.value}),t=JSON.parse($("#portfolio-technologies").val()).map(function(e){return e.value}),[o,a]=$("#portfolio-date").val().split(" to ");$("#content-text").is(":visible")&&$("#content-html").val(n.root.innerHTML),$.blockUI({message:elementLoader,css:{backgroundColor:"transparent",border:"0"},overlayCSS:{backgroundColor:"#fff",opacity:.8}}),$.ajax({type:"PUT",data:JSON.stringify({title:$("#portfolio-title").val(),description:$("#portfolio-description").val(),content:$("#content-html").val(),link:$("#portfolio-link").val(),category:e,technologies:t,images:l,status:$("#portfolio-status").val(),startDate:o,endDate:a}),contentType:"application/json",success:function(e){$.unblockUI(),Swal.fire({title:"Good job!",text:e.msg,icon:"success",customClass:{confirmButton:"btn btn-success waves-effect waves-light"}})},error:function(e){$.unblockUI();e=e.responseJSON.msg;Swal.fire({title:"Upss!",text:e||"There is an error!",icon:"error",customClass:{confirmButton:"btn btn-primary"}})}})})});