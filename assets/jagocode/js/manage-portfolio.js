$(function(){let t=$(".datatables-basic"),e=$("#formEditUser"),a;if(e.submit(function(t){t.preventDefault(),e.block({message:'<div class="spinner-border text-primary" role="status"></div>',css:{backgroundColor:"transparent",border:"0"},overlayCSS:{backgroundColor:"#fff",opacity:.8}}),$.ajax({data:e.serialize(),url:e.attr("action"),type:"POST",success:function(t){e.unblock(),e[0].reset(),a.ajax.reload(),$("#modalEdit").modal("hide"),Swal.fire({title:"Good job!",text:t.msg,icon:"success",customClass:{confirmButton:"btn btn-primary"},buttonsStyling:!1})},error:function(t){e.unblock();t=t.responseJSON.msg;Swal.fire({title:"Upss!",text:t||"There is an error!",icon:"error",customClass:{confirmButton:"btn btn-primary"},buttonsStyling:!1})}})}),t.length){let o={Ongoing:"bg-label-warning",Completed:"bg-label-success",Paused:"bg-label-danger"};a=t.DataTable({ajax:{url:"?type=json",type:"GET",beforeSend:function(){$(".card").block({message:elementLoader,css:{backgroundColor:"transparent",border:"0"},overlayCSS:{backgroundColor:"#fff",opacity:.8}})},complete:function(){$(".card").unblock()}},columns:[{data:"_id"},{data:"title"},{data:"category"},{data:"status"},{data:"startDate"},{data:""}],columnDefs:[{className:"control",orderable:!1,searchable:!1,responsivePriority:2,targets:0,render:function(t,e,n,a){return""}},{responsivePriority:1,targets:1,render:function(t,e,n,a){return'<div class="d-flex justify-content-start align-items-center "><img src="'+n.images[0]+'" alt="'+n.title+'" class="rounded me-2 w-px-100"><div class="d-flex flex-column"><h6 class="text-nowrap mb-0">'+n.title+'</h6><small class="text-truncate d-none d-sm-block">'+n.technologies.join(", ")+"</small></div></div>"}},{targets:3,render:function(t,e,n,a){return'<span class="badge '+o[n.status]+'" text-capitalized>'+n.status+"</span>"}},{targets:-2,render:function(t,e,n,a){return new Date(n.startDate).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric"})+" to "+new Date(n.endDate).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric"})}},{targets:-1,title:"Actions",orderable:!1,searchable:!1,render:function(t,e,n,a){return'<div class="d-inline-block text-nowrap"><a href="?type=edit&id='+n._id+'" class="btn btn-sm btn-icon btn-text-secondary rounded-pill waves-effect waves-light"><i class="ti ti-edit ti-md"></i></a><button class="btn btn-sm btn-icon btn-text-secondary rounded-pill waves-effect waves-light dropdown-toggle hide-arrow" data-bs-toggle="dropdown"><i class="ti ti-dots-vertical ti-md"></i></button><div class="dropdown-menu dropdown-menu-end m-0"><a href="'+n.link+'" target="_blank" class="dropdown-item">View</a><button class="dropdown-item text-danger btn-delete" data-id="'+n._id+'">Delete</button></div></div>'}}],dom:'<"card-header flex-column flex-md-row"<"head-label text-center"><"dt-action-buttons text-end pt-3 pt-md-0"B>><"row"<"col-sm-12 col-md-6"l><"col-sm-12 col-md-6 d-flex justify-content-center justify-content-md-end"f>>t<"row"<"col-sm-12 col-md-6"i><"col-sm-12 col-md-6"p>>',displayLength:7,lengthMenu:[7,10,25,50,75,100],buttons:[{text:'<i class="ti ti-plus me-sm-1"></i> <span class="d-none d-sm-inline-block">New Portfolio</span>',className:"create-new btn btn-primary waves-effect waves-light",action:function(){location.href="?type=new"}}],responsive:{details:{display:$.fn.dataTable.Responsive.display.modal({header:function(t){t.data();return"Portfolio Details"}}),type:"column",renderer:function(t,e,n){n=$.map(n,function(t,e){return""!==t.title?'<tr data-dt-row="'+t.rowIndex+'" data-dt-column="'+t.columnIndex+'"><td>'+t.title+":</td> <td>"+t.data+"</td></tr>":""}).join("");return!!n&&$('<table class="table"/><tbody />').append(n)}}}}),$("div.head-label").html('<h5 class="card-title mb-0">Manage Portfolio</h5>')}$(".datatables-basic tbody").on("click",".btn-delete",function(){let e=$(this),n=e.data("id");Swal.fire({title:"Are you sure?",text:"Do you want to delete this portfolio!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",customClass:{confirmButton:"btn btn-primary me-3 waves-effect waves-light",cancelButton:"btn btn-label-secondary waves-effect waves-light"},buttonsStyling:!1}).then(function(t){t.value&&($.blockUI({message:elementLoader,css:{backgroundColor:"transparent",border:"0"},overlayCSS:{backgroundColor:"#fff",opacity:.8}}),$.ajax({url:"?id="+n,type:"DELETE",success:function(t){$.unblockUI(),a.row(e.parents("tr")).remove().draw(),Swal.fire({title:"Good job!",text:t.msg,icon:"success",customClass:{confirmButton:"btn btn-success waves-effect waves-light"}})},error:function(t){$.unblockUI();t=t.responseJSON.msg;Swal.fire({title:"Upss!",text:t||"There is an error!",icon:"error",customClass:{confirmButton:"btn btn-primary"}})}}))})}),setTimeout(()=>{$(".dataTables_filter .form-control").removeClass("form-control-sm"),$(".dataTables_length .form-select").removeClass("form-select-sm")},300)});